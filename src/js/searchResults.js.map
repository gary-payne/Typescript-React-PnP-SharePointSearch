{"version":3,"sources":["searchResults.tsx"],"names":[],"mappings":"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","file":"searchResults.js","sourcesContent":["import * as React from \"react\";\r\nimport * as ReactDOM from \"react-dom\";\r\nimport pnp from \"sp-pnp-js\";\r\nimport { SearchResult } from \"./searchResult\";\r\n\r\nexport class SearchResults extends React.Component<ISearchResultsProps, ISearchResultsState> {\r\n\r\n    constructor(props: ISearchResultsProps) {\r\n        super(props);\r\n        console.log(\"constructor\");\r\n        this.state = {\r\n            loading: false,\r\n            query: this.props.query,\r\n            results: [],\r\n            resultCount: 0\r\n        };        \r\n        this.submitSearch();\r\n    }\r\n    \r\n    shouldComponentUpdate(nextProps, nextState) {\r\n        console.log(\"shouldComponentUpdate\");\r\n        return (\r\n            nextState.resultCount !== this.state.resultCount ||\r\n            nextState.results !== this.state.results ||\r\n            nextState.loading !== this.state.loading\r\n        );\r\n    }\r\n\r\n    searchTextChanged = (e) => {\r\n        console.log(\"searchTextChanged\");\r\n            this.setState({\r\n                loading: false,\r\n                query: e.target.value, \r\n                results: this.state.results, \r\n                resultCount: this.state.resultCount\r\n        });\r\n    }\r\n\r\n    submitSearch = () => {\r\n        console.log(\"Searching on '\" + this.state.query + \"'\");\r\n        this.setState({\r\n            loading: true,\r\n            query: this.state.query, \r\n            results: [],\r\n            resultCount: 0\r\n        });\r\n        console.log(\" ..adjusted state\");\r\n        pnp.sp.search({\r\n                Querytext: this.state.query,\r\n                RowLimit: 5\r\n            })\r\n                //SelectProperties: [\"Title\", \"Id\", \"Author\", \"Path\"]\r\n            .then((data) => {\r\n                console.log(\"  - got search results\");\r\n                if (typeof data !== 'undefined' && typeof data[\"PrimarySearchResults\"] !== 'undefined') {\r\n                    //setState does not immediately change the state, but creates a pending state transition\r\n                    this.setState({\r\n                        loading: false,\r\n                        query: this.state.query, \r\n                        results: data[\"PrimarySearchResults\"], \r\n                        resultCount: data[\"PrimarySearchResults\"].length\r\n                    });\r\n                }\r\n            })\r\n            .catch((e) => { console.log(\"Error: \" + e.message); });\r\n    }\r\n\r\n    renderSpinner() {\r\n        console.log(\"renderSpinner(): \" + this.state.loading);\r\n        if (!this.state.loading) {\r\n            return null;\r\n        }\r\n        return <div className=\"ms-Spinner\" style={{position: 'absolute'}}></div>\r\n    }\r\n\r\n    public render() {\r\n        //Each dynamic child needs to have a unique key (see https://fb.me/react-warning-keys)\r\n        //  and http://blog.arkency.com/2014/10/react-dot-js-and-dynamic-children-why-the-keys-are-important/\r\n        var resultItems = this.state.results.map((result, i, a) => {\r\n                return (<SearchResult key={result.DocId} result={result} />);\r\n            }, this);\r\n\r\n        //Note - the dynamic element properties DO NOT HAVE SURROUNDING QUOTES\r\n        //Note - the .bind(this) method call COULD be added to the onclick handler so that the instnace context is available in that handler\r\n        //          (without the bind call, the handler is unable to access this.props and this.state)\r\n        //      However, in this case the handler is defined using an arrow function, so \"this\" is available\r\n        return <div>\r\n            <div className=\"ms-TextField\">\r\n                <label className=\"ms-Label\">Search text</label>\r\n                <input type=\"text\" className=\"ms-TextField-field\" defaultValue={this.props.query} onChange={this.searchTextChanged} />\r\n            </div>\r\n            <input type=\"button\" value=\"Search\" onClick={this.submitSearch} />\r\n            {this.renderSpinner()}\r\n            <div className=\"ms-borderColor-tealLight\">Found {this.state.resultCount} results for search term \"{this.state.query}\":</div>\r\n            <ul className=\"ms-List\">\r\n                {resultItems}\r\n            </ul>\r\n        </div>;\r\n    }\r\n}\r\n"],"sourceRoot":"/source/"}